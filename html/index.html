<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KD ONLINE SHOP</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Baloo+2:wght@600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif}
body{background:#000;color:#fff;overflow-x:hidden;position:relative}

/* Header */
header{
    position:fixed;top:0;left:0;width:100%;
    background:#000;padding:20px 20px 60px;
    text-align:center;z-index:1000
}
header h1{color:#fff;font-family:'Orbitron';margin-bottom:5px}
.header-subtext{color:silver;font-size:1.1rem;font-family:'Baloo 2'}
.search-container{position:absolute;bottom:5px;left:50%;transform:translateX(-50%);width:70%;max-width:350px}
.search-container input{
    width:100%;padding:12px 15px;border-radius:25px;border:2px solid #000
}

/* Products */
.products{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
    gap:20px;
    padding:220px 40px 60px;
    max-width:1200px;
    margin:auto
}
.product-card{
    background:#111;border-radius:10px;
    box-shadow:0 5px 15px rgba(255,255,255,.2);
    position:relative;transition:.3s
}
.product-card:hover{transform:scale(1.05)}
.product-card img{width:100%;height:200px;object-fit:cover}

.product-info{text-align:center;padding:15px}
.product-price{font-weight:bold}

/* Buttons */
.btn-container{display:flex;justify-content:center;gap:10px}
.order-btn{background:#ffcc00;border:none;padding:10px 15px;border-radius:25px;cursor:pointer}
.whatsapp-btn{background:#25D366;color:#fff;border:none;padding:10px 15px;border-radius:25px}

/* Menu */
.menu{position:absolute;top:10px;right:10px}
.menu-btn{cursor:pointer;font-size:1.5rem}
.menu-content{
    display:none;
    flex-direction:column;
    position:absolute;
    top:25px;right:0;
    background:#fff;border-radius:8px;
    box-shadow:0 5px 10px rgba(0,0,0,.2)
}
.menu-content button{padding:10px;border:none;background:none;cursor:pointer}
.menu-content button:hover{background:#eee}

/* Add Button */
#add-order-btn{
    position:fixed;bottom:20px;right:20px;
    background:#ffcc00;border:none;
    padding:15px 20px;border-radius:50px;
    font-weight:bold;cursor:pointer;z-index:1000
}

/* Footer */
footer{
    text-align:center;background:#111;color:#fff;
    padding:15px;margin:20px auto;max-width:1200px;border-radius:10px
}

/* Snow Canvas */
#snow-canvas{
    position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:500;
}
</style>
</head>
<body>
<header>
    <h1>KD ONLINE SHOP</h1>
    <div class="header-subtext">A very valuable customer service from us.</div>
    <div class="search-container">
        <input type="text" placeholder="Search products...">
    </div>
</header>

<section class="products"></section>
<button id="add-order-btn">Add Order</button>

<!-- Order Form Modal -->
<div id="order-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);justify-content:center;align-items:center;z-index:2000;">
  <div style="background:#111;padding:20px;border-radius:10px;width:300px;position:relative;color:#fff;">
    <h3>Place Order</h3>
    <p id="modal-product-name"></p>
    <p id="modal-product-price"></p>
    <p id="modal-product-desc"></p>
    <input type="text" id="order-name" placeholder="Your Name" style="width:100%;margin:5px 0;padding:8px;">
    <input type="text" id="order-address" placeholder="Address" style="width:100%;margin:5px 0;padding:8px;">
    <input type="text" id="order-phone" placeholder="Phone" style="width:100%;margin:5px 0;padding:8px;">
    <button id="send-order-btn" style="background:#25D366;color:#fff;padding:10px;width:100%;border:none;border-radius:5px;margin-top:10px;cursor:pointer;">Send via WhatsApp</button>
    <span id="close-modal" style="position:absolute;top:5px;right:10px;cursor:pointer;font-weight:bold;">✖</span>
  </div>
</div>

<!-- Snow Canvas -->
<canvas id="snow-canvas"></canvas>

<footer>© 2025 KD ONLINE SHOP</footer>

<script>
const PASSWORD = "Kkk111";
const STORAGE_KEY = "kd_products";
const whatsappNumber = "9475597160"; 
const DEFAULT_IMG = "https://via.placeholder.com/400x250?text=Product";

// Password check
function checkPassword(){  
    return prompt("Enter password:") === PASSWORD;  
}

// Save products
function saveProducts(){  
    const products=[];  
    document.querySelectorAll(".product-card").forEach(card=>{  
        products.push({  
            name:card.querySelector("h3").textContent,  
            desc:card.querySelector(".product-info p").textContent,  
            price:card.querySelector(".product-price").dataset.price,  
            img:card.querySelector("img").src  
        });  
    });  
    localStorage.setItem(STORAGE_KEY,JSON.stringify(products));  
}

// Load products
function loadProducts(){  
    const data=JSON.parse(localStorage.getItem(STORAGE_KEY));  
    if(!data)return;  
    const section=document.querySelector(".products");  
    section.innerHTML="";  
    data.forEach(p=>createProduct(p.name,p.desc,p.price,p.img,false));  
}

// Create product card
function createProduct(name,desc,price,img,save=true){  
    if(!name || !price) return;
    if(isNaN(price)) return alert("Price must be a number");

    const card=document.createElement("div");  
    card.className="product-card";  
    card.innerHTML=`
        <div class="menu">
            <span class="menu-btn">&#x22EE;</span>
            <div class="menu-content">
                <button class="edit-btn">Edit</button>
                <button class="delete-btn">Delete</button>
            </div>
        </div>
        <img src="${img || DEFAULT_IMG}">
        <div class="product-info">
            <h3>${name}</h3>
            <p>${desc || ""}</p>
            <p class="product-price" data-price="${price}">Price: LKR ${price}</p>
            <div class="btn-container">
                <button class="order-btn">Order Now</button>
                <button class="whatsapp-btn">WhatsApp</button>
            </div>
        </div>`;  
    document.querySelector(".products").appendChild(card);  
    attachEvents(card);  
    if(save) saveProducts();  
}

// Attach events
function attachEvents(card){  
    const menu = card.querySelector(".menu-content");
    const modal = document.getElementById("order-modal");
    const modalName = document.getElementById("modal-product-name");
    const modalPrice = document.getElementById("modal-product-price");
    const modalDesc = document.getElementById("modal-product-desc");
    const orderName = document.getElementById("order-name");
    const orderAddress = document.getElementById("order-address");
    const orderPhone = document.getElementById("order-phone");
    const sendBtn = document.getElementById("send-order-btn");
    const closeModal = document.getElementById("close-modal");

    card.querySelector(".menu-btn").onclick=e=>{
        e.stopPropagation();
        menu.style.display = menu.style.display==="flex" ? "none":"flex";
    };
    document.body.onclick=()=>menu.style.display="none";

    card.querySelector(".edit-btn").onclick=()=>{
        if(!checkPassword())return;
        card.querySelector("h3").textContent = prompt("Name:",card.querySelector("h3").textContent);
        card.querySelector(".product-info p").textContent = prompt("Description:",card.querySelector(".product-info p").textContent);
        const price = prompt("Price:",card.querySelector(".product-price").dataset.price);
        if(isNaN(price)) return alert("Invalid price");
        card.querySelector(".product-price").dataset.price = price;
        card.querySelector(".product-price").textContent = "Price: LKR "+price;
        saveProducts();
    };

    card.querySelector(".delete-btn").onclick=()=>{
        if(!checkPassword())return;
        card.remove(); saveProducts();
    };

    card.querySelector(".whatsapp-btn").onclick=()=>{
        window.open(`https://wa.me/${whatsappNumber}?text=Order: ${card.querySelector("h3").textContent}`);
    };

    // Order Now popup
    card.querySelector(".order-btn").onclick=()=>{
        modalName.textContent = "Product: " + card.querySelector("h3").textContent;
        modalPrice.textContent = "Price: LKR " + card.querySelector(".product-price").dataset.price;
        modalDesc.textContent = "Description: " + card.querySelector(".product-info p").textContent;
        orderName.value = "";
        orderAddress.value = "";
        orderPhone.value = "";
        modal.style.display = "flex";

        sendBtn.onclick = ()=>{
            const n = orderName.value.trim();
            const a = orderAddress.value.trim();
            const p = orderPhone.value.trim();
            if(!n||!a||!p){ alert("Please fill all fields"); return; }

            const msg = `${modalName.textContent}\n${modalPrice.textContent}\n${modalDesc.textContent}\nName: ${n}\nAddress: ${a}\nPhone: ${p}`;
            window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`);
            modal.style.display = "none";
        };
    };

    closeModal.onclick = ()=>modal.style.display="none";
    modal.onclick = e => { if(e.target === modal) modal.style.display="none"; };
}

// Add product
document.getElementById("add-order-btn").onclick=()=>{  
    if(!checkPassword())return;  
    createProduct(  
        prompt("Product name"),  
        prompt("Description"),  
        prompt("Price"),  
        prompt("Image URL")  
    );  
};

// Search
document.querySelector(".search-container input").oninput=e=>{  
    const v=e.target.value.toLowerCase();  
    document.querySelectorAll(".product-card").forEach(c=>{  
        c.style.display=c.textContent.toLowerCase().includes(v)?"":"none";  
    });  
};

window.onload=loadProducts;

/* Emoji Snowfall */
const canvas = document.getElementById("snow-canvas");
const ctx = canvas.getContext("2d");
let w = canvas.width = window.innerWidth;
let h = canvas.height = window.innerHeight;

window.addEventListener("resize", () => {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
});

const numFlakes = 100;
const flakes = [];

for(let i=0;i<numFlakes;i++){
    flakes.push({
        x: Math.random()*w,
        y: Math.random()*h,
        r: Math.random()*20+10, // emoji size
        d: Math.random()*numFlakes
    });
}

function drawFlakes(){
    ctx.clearRect(0,0,w,h);
    for(let i=0;i<numFlakes;i++){
        let f = flakes[i];
        ctx.font = `${f.r}px Arial`;
        ctx.fillText("❄️", f.x, f.y);
    }
    moveFlakes();
}

let angle = 0;
function moveFlakes(){
    angle += 0.01;
    for(let i=0;i<numFlakes;i++){
        let f = flakes[i];
        f.y += Math.cos(angle + f.d) + 1 + f.r/20;
        f.x += Math.sin(angle) * 2;

        if(f.x > w+5 || f.x < -5 || f.y > h){
            if(i%3 > 0){
                flakes[i] = {x: Math.random()*w, y: -10, r: f.r, d: f.d};
            } else {
                if(Math.sin(angle) > 0){
                    flakes[i] = {x: -5, y: Math.random()*h, r: f.r, d: f.d};
                } else {
                    flakes[i] = {x: w+5, y: Math.random()*h, r: f.r, d: f.d};
                }
            }
        }
    }
}

setInterval(drawFlakes, 25);
</script>
</body>
</html>
