<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KD ONLINE SHOP</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Baloo+2:wght@600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif}
body{background:#fff;color:#000;overflow-x:hidden;position:relative}

/* Header */
header{
    position:fixed;top:0;left:0;width:100%;
    background:#000;padding:20px 20px 60px;
    text-align:center;z-index:1000
}
header h1{color:#fff;font-family:'Orbitron';margin-bottom:5px}
.header-subtext{
    color: silver;
    font-size: 1.1rem;
    font-family: 'Baloo 2';
    white-space: nowrap; 
    display: inline-block; 
}
.search-container{position:absolute;bottom:5px;left:50%;transform:translateX(-50%);width:70%;max-width:350px}
.search-container input{
    width:100%;padding:12px 15px;border-radius:25px;border:2px solid #000
}

/* Products */
.products{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
    gap:20px;
    padding:220px 40px 60px;
    max-width:1200px;
    margin:auto
}
.product-card{
    background:#fff;border-radius:10px;
    box-shadow:0 5px 15px rgba(0,0,0,.2);
    position:relative;transition:.3s
}
.product-card:hover{transform:scale(1.05)}
.product-card img{width:100%;height:200px;object-fit:cover}
.product-info{text-align:center;padding:15px}
.product-price{font-weight:bold}

/* Buttons */
.btn-container{display:flex;justify-content:center;gap:10px}
.order-btn{background:#ffcc00;border:none;padding:10px 15px;border-radius:25px;cursor:pointer}
.whatsapp-btn{background:#25D366;color:#fff;border:none;padding:10px 15px;border-radius:25px}

/* Modals */
.modal {
    display:none;
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.5);
    justify-content:center;
    align-items:center;
    z-index:2000;
}
.modal-content {
    background:#fff;padding:20px;border-radius:10px;width:300px;position:relative;
}
.modal-content h3{margin-bottom:10px}
.modal-content input{width:100%;margin:5px 0;padding:8px}
.modal-content button{margin-top:10px;cursor:pointer}

/* Footer */
footer{
    text-align:center;background:#111;color:#fff;
    padding:15px;margin:20px auto;max-width:1200px;border-radius:10px
}

/* Snow Effect */
.snowflake {
    position: fixed;
    top: -2em;
    color: #fff;
    font-size: 1em;
    z-index: 9999;
    user-select: none;
    pointer-events: none;
    opacity: 0.8;
    animation-name: fall;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
}

@keyframes fall {
    0% { transform: translateY(-2em) rotate(0deg); }
    100% { transform: translateY(110vh) rotate(360deg); }
}
</style>
</head>
<body>
<header>
    <h1>KD ONLINE SHOP</h1>
    <div class="header-subtext">A very valuable customer service from us.</div>
    <div class="search-container">
        <input type="text" placeholder="Search products...">
    </div>
</header>

<section class="products"></section>

<!-- Order Form Modal -->
<div id="order-modal" class="modal">
  <div class="modal-content">
    <h3>Place Order</h3>
    <p id="modal-product-name"></p>
    <p id="modal-product-price"></p>
    <p id="modal-product-desc"></p>
    <input type="text" id="order-name" placeholder="Your Name">
    <input type="text" id="order-address" placeholder="Address">
    <input type="text" id="order-phone" placeholder="Phone">
    <button id="send-order-btn" style="background:#25D366;color:#fff;width:100%;border:none;border-radius:5px;">Send via WhatsApp</button>
    <span id="close-modal" style="position:absolute;top:5px;right:10px;cursor:pointer;font-weight:bold;">✖</span>
  </div>
</div>

<footer>© 2025 KD ONLINE SHOP</footer>

<script>
const STORAGE_KEY = "kd_products";
const whatsappNumber = "94755997160";
const DEFAULT_IMG = "https://via.placeholder.com/400x250?text=Product";

// Load products
function loadProducts(){  
    const data=JSON.parse(localStorage.getItem(STORAGE_KEY));  
    if(!data)return;  
    const section=document.querySelector(".products");  
    section.innerHTML="";  
    data.forEach(p=>createProduct(p.name,p.desc,p.price,p.img,false));  
}

// Create product card
function createProduct(name,desc,price,img){  
    if(!name || !price) return;
    if(isNaN(price)) return alert("Price must be a number");

    const card=document.createElement("div");  
    card.className="product-card";  
    card.innerHTML=`
        <img src="${img || DEFAULT_IMG}">
        <div class="product-info">
            <h3>${name}</h3>
            <p>${desc || ""}</p>
            <p class="product-price" data-price="${price}">Price: LKR ${price}</p>
            <div class="btn-container">
                <button class="order-btn">Order Now</button>
                <button class="whatsapp-btn">WhatsApp</button>
            </div>
        </div>`;  
    document.querySelector(".products").appendChild(card);  
    attachEvents(card);  
}

// Attach events
function attachEvents(card){  
    const modal = document.getElementById("order-modal");
    const modalName = document.getElementById("modal-product-name");
    const modalPrice = document.getElementById("modal-product-price");
    const modalDesc = document.getElementById("modal-product-desc");
    const orderName = document.getElementById("order-name");
    const orderAddress = document.getElementById("order-address");
    const orderPhone = document.getElementById("order-phone");
    const sendBtn = document.getElementById("send-order-btn");
    const closeModal = document.getElementById("close-modal");

    card.querySelector(".whatsapp-btn").onclick=()=>{
        window.open(`https://wa.me/${whatsappNumber}?text=Order: ${card.querySelector("h3").textContent}`);
    };

    card.querySelector(".order-btn").onclick=()=>{
        modalName.textContent = "Product: " + card.querySelector("h3").textContent;
        modalPrice.textContent = "Price: LKR " + card.querySelector(".product-price").dataset.price;
        modalDesc.textContent = "Description: " + card.querySelector(".product-info p").textContent;
        orderName.value = "";
        orderAddress.value = "";
        orderPhone.value = "";
        modal.style.display = "flex";

        sendBtn.onclick = ()=>{
            const n = orderName.value.trim();
            const a = orderAddress.value.trim();
            const p = orderPhone.value.trim();
            if(!n||!a||!p){ alert("Please fill all fields"); return; }

            const msg = `${modalName.textContent}\n${modalPrice.textContent}\n${modalDesc.textContent}\nName: ${n}\nAddress: ${a}\nPhone: ${p}`;
            window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`);
            modal.style.display = "none";
        };
    };

    closeModal.onclick = ()=>modal.style.display="none";
}

// Search
document.querySelector(".search-container input").oninput=e=>{  
    const v=e.target.value.toLowerCase();  
    document.querySelectorAll(".product-card").forEach(c=>{  
        const name = c.querySelector("h3").textContent.toLowerCase();
        const desc = c.querySelector(".product-info p").textContent.toLowerCase();
        c.style.display = (name.includes(v) || desc.includes(v)) ? "" : "none";  
    });  
};

window.onload=loadProducts;

// Snow Effect
const snowCount = 20;
for(let i = 0; i < snowCount; i++){
    const snow = document.createElement("div");
    snow.className = "snowflake";
    snow.textContent = "❄️";
    snow.style.left = Math.random() * 100 + "vw";
    snow.style.fontSize = (Math.random()*1.5 + 0.5) + "em";
    snow.style.animationDuration = (Math.random()*5 + 8) + "s";
    snow.style.opacity = Math.random() * 0.5 + 0.5;
    document.body.appendChild(snow);
}

// Close modal when clicking outside
window.onclick = function(e) {
    if(e.target === document.getElementById("order-modal")) document.getElementById("order-modal").style.display = "none";
};
</script>
</body>
</html>
